
# display version numbers
# - - - - - - - - - - - -
# the base-language versions be gathered from the dependency table
# I can split the table into named sections and create a section for the
# base-language entries and then the version numbers
# can be harvested from that.

# TODO: add checks that the version numbers of
# the repo-name and the image-name match up.

# TODO: add check that the repo-names version
# numbers use -1.2.3 format.

# TODO: add check that the image-names for
# base images use version numbers use :1.2.3 format.

# TODO: add check that the image-names for
# language+test images do NOT use version numbers.
# Is this what I want?
# I could a version number here and then _also_
# tag the image as latest (and push that)
# (possibly with a command line option).
# Orthogonal to that, what version number do I use?
# The language's or the test framework's? Or both?


#===========================================
This goes into Dockerfile

ARG  DOCKER_COMPOSE_VERSION

USER root

# - - - - - - - - - - - - - - - - - - - - - -
# install docker-compose

ARG DOCKER_COMPOSE_BINARY=/usr/bin/docker-compose
RUN apk add --no-cache curl openssl ca-certificates \
 && curl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname -s`-`uname -m` > ${DOCKER_COMPOSE_BINARY} \
 && chmod +x ${DOCKER_COMPOSE_BINARY} \
 && wget -q -O /etc/apk/keys/sgerrand.rsa.pub https://raw.githubusercontent.com/sgerrand/alpine-pkg-glibc/master/sgerrand.rsa.pub \
 && wget https://github.com/sgerrand/alpine-pkg-glibc/releases/download/2.23-r3/glibc-2.23-r3.apk \
 && apk add --no-cache glibc-2.23-r3.apk && rm glibc-2.23-r3.apk \
 && ln -s /lib/libz.so.1 /usr/glibc-compat/lib/ \
 && ln -s /lib/libc.musl-x86_64.so.1 /usr/glibc-compat/lib \
 && apk del curl

# smoke-test it installed
RUN docker-compose --version


#===========================================
This goes into docker-compose.yml
    build:
      context: .
      args:
        - DOCKER_COMPOSE_VERSION

#===========================================
This goes into build.sh
export DOCKER_COMPOSE_VERSION=${1:-1.14.0-rc2}


